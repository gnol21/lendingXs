$(document).ready((function(){let t="https://iptv.givethanksgrocers.com/lending/cashflow.php";var e=0;function n(t){t?($("#loading-spinner").show(),$("button").prop("disabled",!0)):($("#loading-spinner").hide(),$("button").prop("disabled",!1))}function a(){n(!0),$.ajax({url:t,type:"GET",success:function(t){let a=function(){let t=new Date,e=("0"+t.getDate()).slice(-2),n=("0"+(t.getMonth()+1)).slice(-2);return t.getFullYear()+"-"+n+"-"+e}();var s=$("#table-body");s.empty(),s.append(`<tr>\n    <td style="width: 5%;" contenteditable="false">New</td>\n    <td class="text-capitalize" style="width: 15%;"><input value="${a}" id="cashflow-date" class="border-0" type="date" style="width: 100%;" /></td>\n    <td class="text-capitalize" style="width: 15%;"><select id="cashflow-type" class="border-0" style="width: 100%;">\n            <option value="Cash In">Cash In</option>\n            <option value="Cash Out">Cash Out</option>\n        </select></td>\n    <td id="cashflow-amount" style="width: 10%;" contenteditable="true"></td>\n    <td id="cashflow-description" class="text-capitalize text-center" contenteditable="true"></td>\n    <td style="width: 10%;"><button id="add-cashflow-btn" class="btn btn-primary btn-sm add-btn" type="button" style="width: 100%;">Add</button></td>\n</tr>`),t.forEach((function(t){var n;e++,s.append(`\n                        <tr>\n                            <td>${e}</td>\n                            <td>${function(t){let e=t.split("-");return e[2]+"-"+e[1]+"-"+e[0]}(t.Date)}</td>\n                            <td>${t.Type}</td>\n                            <td>â‚±${n=t.Amount,n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}</td>\n                            <td class="text-center text-capitalize">${t.Description}</td>\n                            <td><button class="btn btn-danger btn-sm delete-btn" data-id="${t.TransactionID}" type="button" style="width: 100%;">Delete</button></td>\n                        </tr>\n                    `)})),n(!1)},error:function(t,e,a){n(!1),console.error("Error:",a),alert("Failed to load borrowers. Please try again.")}}),e=0}a(),$("#table-body").on("click",".add-btn",(function(){let e={date:$("#cashflow-date").val(),type:$("#cashflow-type").val(),amount:parseFloat($("#cashflow-amount").text()),description:$("#cashflow-description").text()};!e.date||isNaN(e.amount)||e.amount<=0?alert("Please provide valid inputs"):(n(!0),$.ajax({url:t,type:"POST",data:JSON.stringify(e),contentType:"application/json",success:function(t){$("#table-body");alert("Cash flow entry added successfully"),a(),n(!1)},error:function(t,e,a){alert("Error: "+t.responseJSON.message),n(!1)}}))})),$("#table-body").on("click",".delete-btn",(function(){var t=$(this).data("id");n(!0),$.ajax({url:`https://iptv.givethanksgrocers.com/lending/cashflow.php?id=${t}`,type:"DELETE",success:function(t){alert("Cash flow entry deleted successfully"),a(),n(!1)},error:function(t,e,a){n(!1),alert("Error: "+t.responseJSON.message)}})}))}));